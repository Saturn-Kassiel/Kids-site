@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,300;0,400;0,500;0,600&display=swap');

/* ===== TOKENS ===== */
:root {
    --grad:        linear-gradient(135deg, #a78bfa, #60a5fa, #34d399);
    --grad-purple: linear-gradient(135deg, #a78bfa, #7c3aed);
    --grad-blue:   linear-gradient(135deg, #93c5fd, #3b82f6);
    --grad-pink:   linear-gradient(135deg, #f9a8d4, #ec4899);
    --grad-yellow: linear-gradient(135deg, #fde68a, #f59e0b);
    --grad-green:  linear-gradient(135deg, #6ee7b7, #10b981);
    --grad-orange: linear-gradient(135deg, #fdba74, #f97316);
    --grad-red:    linear-gradient(135deg, #fca5a5, #ef4444);
    --grad-teal:   linear-gradient(135deg, #5eead4, #0d9488);

    --bg:      #f0f4ff;
    --bg2:     #e8eeff;
    --card:    #ffffff;
    --card2:   #f5f8ff;
    --text:    #1a1f3c;
    --text2:   #5a6080;
    --border:  rgba(90,96,128,0.13);
    --shadow:  0 4px 20px rgba(80,100,200,0.10);
    --shadow-lg: 0 8px 36px rgba(80,100,200,0.18);
    --radius:  20px;
    --radius-sm: 13px;
    --font: 'Plus Jakarta Sans', system-ui, sans-serif;
    --font-display: 'Plus Jakarta Sans', system-ui, sans-serif;
    --fw-normal: 400;
    --fw-medium: 500;
    --fw-semi:   600;
    --tr: 0.22s cubic-bezier(.4,0,.2,1);
}

/* ══ ПАЛИТРА LUNA для тёмной темы ══
   #A7EBF2 — светлый акцент (текст, иконки)
   #54ACBF — средний акцент (кнопки, прогресс)
   #26658C — основной синий (карточки)
   #023859 — тёмный фон карточек
   #011C40 — самый тёмный фон */
[data-theme="dark"] {
    --luna-light:  #A7EBF2;
    --luna-mid:    #54ACBF;
    --luna-main:   #26658C;
    --luna-dark:   #023859;
    --luna-deep:   #011C40;

    --bg:      #011C40;
    --bg2:     #023859;
    --card:    #0a2d54;
    --card2:   #0d3464;
    --text:    #d4f0f5;
    --text2:   #7ab8cc;
    --border:  rgba(84,172,191,0.18);
    --shadow:  0 4px 24px rgba(1,28,64,0.6);
    --shadow-lg: 0 8px 40px rgba(1,28,64,0.8);

    --grad:        linear-gradient(135deg, #54ACBF, #A7EBF2);
    --grad-purple: linear-gradient(135deg, #26658C, #54ACBF);
    --grad-blue:   linear-gradient(135deg, #023859, #26658C);
    --grad-pink:   linear-gradient(135deg, #54ACBF, #A7EBF2);
    --grad-yellow: linear-gradient(135deg, #A7EBF2, #54ACBF);
    --grad-green:  linear-gradient(135deg, #54ACBF, #26658C);
    --grad-orange: linear-gradient(135deg, #26658C, #54ACBF);
    --grad-red:    linear-gradient(135deg, #023859, #26658C);
    --grad-teal:   linear-gradient(135deg, #A7EBF2, #54ACBF);
}

/* ===== RESET ===== */
*, *::before, *::after {
    box-sizing: border-box; margin: 0; padding: 0;
    font-family: 'Plus Jakarta Sans', system-ui, sans-serif;
    font-weight: 400; /* Тонкий шрифт везде по умолчанию */
}
html { scroll-behavior: smooth; }
body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--font);
    font-weight: 400;
    transition: background var(--tr), color var(--tr);
    -webkit-tap-highlight-color: transparent;
    min-height: 100vh;
}
::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-thumb { background: var(--grad); border-radius: 99px; }

/* ══ ГЛОБАЛЬНЫЙ ЗАПРЕТ НА ЖИРНЫЙ ШРИФТ ══ */
* { font-weight: 400 !important; }
/* Исключения: только там где нужно чуть выделить — medium/semi */
.track-name, .song-name, h1, h2, h3, .home-logo,
#page-title-bar, .modal-title, .admin-item-title,
.s-label, .stat-num, .level-tab {
    font-weight: 500 !important;
}
input, select, textarea, button, label, option {
    font-family: 'Plus Jakarta Sans', system-ui, sans-serif !important;
    font-weight: 400 !important;
}
/* ===== LAYOUT ===== */
#app {
    max-width: 480px;
    margin: 0 auto;
    min-height: 100vh;
    position: relative;
    display: flex;
    flex-direction: column;
}
@media(min-width:600px) { #app { box-shadow: 0 0 60px rgba(0,0,0,0.12); } }

/* ===== TOP BAR ===== */
#top-bar {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 14px 18px 10px;
    position: sticky;
    top: 0;
    z-index: 200;
    background: transparent;
    backdrop-filter: none;
}
#back-btn {
    display: flex;
    align-items: center;
    gap: 7px;
    background: var(--card);
    border: none;
    border-radius: var(--radius-sm);
    padding: 8px 15px;
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-size: 14px;
    font-weight: 500 !important;
    color: var(--text2);
    cursor: pointer;
    box-shadow: var(--shadow);
    transition: all var(--tr);
}
#back-btn:hover { transform: translateX(-3px); }
#back-btn svg { width: 17px; height: 17px; }
#page-title-bar {
    font-family: var(--font-display);
    font-size: 21px;
    background: var(--grad);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    flex: 1;
}
#settings-icon-btn {
    background: var(--card);
    border: none;
    border-radius: 12px;
    width: 38px; height: 38px;
    font-size: 18px;
    cursor: pointer;
    box-shadow: var(--shadow);
    display: flex; align-items: center; justify-content: center;
    transition: all var(--tr);
}
#settings-icon-btn:hover { transform: rotate(25deg) scale(1.1); }

/* ===== SECTIONS ===== */
section { flex: 1; padding: 0 18px 28px; animation: fadeInUp 0.35s ease both; }
section.hidden { display: none !important; }
.hidden { display: none !important; }
@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(14px); }
    to   { opacity: 1; transform: translateY(0); }
}

/* ===== MAIN / HOME ===== */
#main { padding-top: 10px; }
.home-logo {
    font-size: 34px;
    text-align: center;
    background: var(--grad);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    padding: 20px 0 6px;
    line-height: 1.1;
    font-weight: 500 !important;
}
.home-sub {
    text-align: center;
    font-size: 14px;
    color: var(--text2);
    margin-bottom: 18px;
}
.menu-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}
/* Плашки — чистые, без полосок */
.menu-card {
    background: var(--card);
    border: 1.5px solid var(--border);
    padding: 22px 14px;
    border-radius: 18px;
    box-shadow: var(--shadow);
    cursor: pointer;
    font-size: 14px;
    color: var(--text);
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    line-height: 1.3;
    transition: all var(--tr);
    text-decoration: none;
    min-height: 72px;
}
.menu-card:hover  { transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.menu-card:active { transform: scale(0.97); }

/* ===== MEDIA PAGE ===== */
#video-wrap {
    width: 100%;
    border-radius: var(--radius);
    overflow: hidden;
    background: linear-gradient(135deg, #0d1b2e 0%, #1a2744 100%);
    aspect-ratio: 1/1;
    position: relative;
    margin-bottom: 12px;
}
#video-wrap video {
    width: 100%; height: 100%;
    object-fit: cover;
    pointer-events: none;
    display: none; /* скрыт по умолчанию, показывается когда видео загружено */
}
.video-placeholder-inner {
    position: absolute; inset: 0;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    gap: 10px; color: rgba(255,255,255,0.55);
    font-size: 15px; letter-spacing: 0.02em;
}
.video-placeholder-inner .pi {
    font-size: 52px; opacity: 0.35;
    filter: drop-shadow(0 2px 8px rgba(0,0,0,0.4));
}

/* ===== AUDIO PLAYER — стиль референса ===== */
.audio-player {
    background: linear-gradient(135deg, #7c4dff 0%, #26a69a 100%);
    border-radius: 22px;
    padding: 14px 18px;
    box-shadow: 0 8px 32px rgba(124,77,255,0.35);
    margin-bottom: 12px;
    position: relative;
    overflow: hidden;
}
/* Лёгкое мерцание — оверлей */
.audio-player::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(180deg, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0.06) 100%);
    border-radius: 22px;
    pointer-events: none;
}

/* Название трека над плеером — белое */
.track-info {
    display: none; /* скрываем — трек-инфо переносим над прогрессом */
}

/* Строка: название + длительность */
.player-track-row {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 10px;
}
.track-name {
    font-size: 14px;
    color: rgba(255,255,255,0.9);
    font-weight: 500 !important;
    white-space: nowrap; overflow: visible;
}
.track-sub { font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 0; }

/* Строка с кнопкой play + прогресс + время */
.player-main-row {
    display: flex; align-items: center; gap: 12px;
}

/* Прогресс-бар — посередине */
.progress-bar-wrap {
    flex: 1;
    height: 5px;
    background: rgba(255,255,255,0.25);
    border-radius: 99px;
    cursor: pointer;
    position: relative;
    margin-bottom: 0;
}
.progress-bar-wrap > div {
    height: 100%;
    background: rgba(255,255,255,0.85);
    border-radius: 99px;
    width: 0%;
    transition: width 0.3s linear;
    position: relative;
}
/* Овальная ручка на прогрессе */
.progress-bar-wrap > div::after {
    content: '';
    position: absolute;
    right: -7px; top: 50%;
    transform: translateY(-50%);
    width: 14px; height: 14px;
    background: white;
    border-radius: 50%;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

/* Время — белое, по бокам прогресса */
.progress-times {
    display: none; /* встроим время в player-main-row */
}
.player-time {
    font-size: 12px;
    color: rgba(255,255,255,0.85);
    white-space: nowrap;
    min-width: 36px;
}
.player-time-cur { text-align: right; }
.player-time-dur { text-align: left; }

/* Кнопки управления — снизу */
.player-btns {
    display: flex; align-items: center; justify-content: center;
    gap: 24px;
    margin-top: 14px;
}

/* Вспомогательные кнопки */
.ctrl-btn {
    background: rgba(255,255,255,0.15);
    border: none;
    width: 36px; height: 36px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    color: rgba(255,255,255,0.85);
    font-size: 16px;
    border-radius: 50%;
    transition: all var(--tr);
    padding: 0;
    backdrop-filter: blur(4px);
}
.ctrl-btn:hover  { background: rgba(255,255,255,0.28); color: white; transform: scale(1.1); }
.ctrl-btn:active { transform: scale(0.90); }
.ctrl-btn.active { background: rgba(255,255,255,0.35); color: white; }

/* Кнопка Play — белый круг с тенью */
#play-btn, #song-play-btn, #podcast-play-btn {
    width: 52px; height: 52px;
    border-radius: 50%;
    background: white;
    border: none;
    cursor: pointer;
    color: #5e35b1;
    font-size: 20px;
    display: flex; align-items: center; justify-content: center;
    transition: all var(--tr);
    box-shadow: 0 4px 20px rgba(0,0,0,0.25);
    padding: 0;
    flex-shrink: 0;
}
#play-btn:hover, #song-play-btn:hover, #podcast-play-btn:hover {
    transform: scale(1.08);
    box-shadow: 0 6px 28px rgba(0,0,0,0.35);
}
#play-btn:active, #song-play-btn:active, #podcast-play-btn:active {
    transform: scale(0.94);
}

/* ===== CHIPS GRID ===== */
.chips-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
    gap: 8px;
}
.chip {
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 10px 4px;
    text-align: center;
    font-family: var(--font-display);
    font-size: 19px;
    cursor: pointer;
    transition: all var(--tr);
    box-shadow: var(--shadow);
}
.chip:hover  { transform: scale(1.1); border-color: #a78bfa; }
.chip:active { transform: scale(0.92); }
.chip.active { background: var(--grad); color: white; border-color: transparent; box-shadow: 0 3px 12px rgba(120,100,220,0.38); }

/* Color chips */
.color-chip {
    border-radius: var(--radius-sm);
    padding: 13px 6px;
    text-align: center;
    font-family: var(--font-display);
    font-size: 13px;
    cursor: pointer;
    color: white;
    font-weight: 500 !important;
    text-shadow: 0 1px 3px rgba(0,0,0,0.3);
    transition: all var(--tr);
    box-shadow: var(--shadow);
}
.color-chip:hover  { transform: scale(1.06); }
.color-chip:active { transform: scale(0.93); }
.color-chip.active { outline: 3px solid white; outline-offset: 2px; }

/* ===== SONGS ===== */
.search-bar {
    display: flex; align-items: center; gap: 10px;
    background: var(--card);
    border-radius: var(--radius-sm);
    padding: 10px 15px;
    box-shadow: var(--shadow);
    margin-bottom: 10px;
}
.search-bar input {
    flex: 1; border: none; background: transparent;
    font-family: var(--font); font-size: 15px; color: var(--text); outline: none;
}
.search-bar input::placeholder { color: var(--text2); }
.songs-list {
    background: var(--card);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow: hidden;
    max-height: 52vh;
    overflow-y: auto;
}
.song-item {
    display: flex; align-items: center; padding: 11px 15px; gap: 11px;
    cursor: pointer; transition: background var(--tr);
    border-bottom: 1px solid var(--border);
}
.song-item:last-child { border-bottom: none; }
.song-item:hover { background: var(--card2); }
.song-item.playing { background: linear-gradient(90deg, rgba(167,139,250,0.12), transparent); }
.song-num { width: 26px; text-align: center; font-size: 12px; color: var(--text2); font-weight: 500 !important; font-family: 'Plus Jakarta Sans', sans-serif; flex-shrink: 0; }
.song-num.pi-icon { color: #7c3aed; }
.song-name { flex: 1; font-weight: 500 !important; font-size: 14px; font-family: 'Plus Jakarta Sans', sans-serif; }
.song-dur  { font-size: 12px; color: var(--text2); }
.deeplink-btn {
    flex-shrink: 0;
    background: none;
    border: 1.5px solid var(--border);
    border-radius: 8px;
    padding: 3px 7px;
    font-size: 13px;
    color: var(--text2);
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.15s, background 0.15s, color 0.15s;
    margin-left: 4px;
    line-height: 1;
}
.song-item:hover .deeplink-btn { opacity: 1; }
.deeplink-btn:hover { background: var(--card2); color: #54ACBF; border-color: #54ACBF; }
/* На тач-устройствах hover не работает — показываем всегда */
@media (hover: none) {
    .deeplink-btn { opacity: 0.5; }
    .deeplink-btn:active { opacity: 1; background: var(--card2); color: #54ACBF; border-color: #54ACBF; }
}

/* ===== RIDDLES / PUZZLES ===== */
.riddle-box {
    background: var(--card);
    border-radius: var(--radius);
    padding: 22px 18px;
    font-family: var(--font-display);
    font-size: 20px;
    line-height: 1.6;
    text-align: center;
    box-shadow: var(--shadow);
    white-space: pre-line;
    margin-bottom: 10px;
}
.hint-box {
    background: linear-gradient(135deg, #fde68a22, #f59e0b22);
    border: 2px solid #f59e0b44;
    border-radius: var(--radius-sm);
    padding: 12px 15px;
    font-size: 14px; font-weight: 500 !important;
    line-height: 1.5;
    margin-bottom: 10px;
}
.puzzle-img-wrap {
    width: 100%; aspect-ratio: 1/1;
    border-radius: var(--radius);
    background: transparent;
    display: flex; align-items: center; justify-content: center;
    font-size: 64px;
    overflow: hidden;
    margin-bottom: 10px;
}
.answer-img {
    display: none; /* скрыт по умолчанию */
    width: 100%;
    text-align: center;
    font-size: 80px;
    border-radius: var(--radius);
    margin-top: 10px;
    animation: fadeInUp 0.4s ease;
}
/* При появлении добавляем стили */
.answer-img.show {
    display: block;
    background: var(--card);
    padding: 20px;
    box-shadow: var(--shadow);
}

input[type=text], input[type=password] {
    width: 100%;
    padding: 13px 15px;
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: var(--radius-sm);
    font-family: var(--font);
    font-size: 16px;
    color: var(--text);
    outline: none;
    transition: border-color var(--tr);
    margin-bottom: 8px;
}
input:focus { border-color: #a78bfa; }
input.correct { border-color: #10b981; background: #10b98110; }
input.wrong   { border-color: #ef4444; background: #ef444410; }

.action-btn, .submit-btn {
    width: 100%;
    padding: 14px;
    background: var(--grad);
    border: none;
    border-radius: var(--radius-sm);
    font-family: var(--font-display);
    font-size: 18px;
    color: white;
    cursor: pointer;
    box-shadow: 0 4px 14px rgba(120,100,220,0.32);
    transition: all var(--tr);
    margin-top: 4px;
}
.action-btn:hover, .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 22px rgba(120,100,220,0.45); }
.action-btn:active, .submit-btn:active { transform: scale(0.97); }
/* Строка кнопок загадки */
.riddle-btns-row {
    display: flex; gap: 8px; margin-top: 6px;
}
.riddle-btns-row .submit-btn {
    flex: 1.4; margin-top: 0; font-size: 15px; padding: 13px 10px;
}
.riddle-btns-row .next-btn {
    flex: 1; margin-top: 0; font-size: 15px; padding: 13px 10px;
}
.next-btn {
    display: flex; align-items: center; justify-content: center; gap: 8px;
    width: 100%; padding: 12px;
    background: var(--card); border: 2px solid var(--border);
    border-radius: var(--radius-sm);
    font-family: var(--font-display); font-size: 16px;
    color: var(--text2); cursor: pointer;
    transition: all var(--tr); margin-top: 8px;
}
.next-btn:hover { border-color: #a78bfa; color: var(--text); }
/* Кнопка поделиться загадкой в топ-баре */
#riddle-share-topbar, #puzzle-share-topbar {
    background: var(--card); border: none;
    border-radius: var(--radius-sm);
    width: 38px; height: 38px;
    font-size: 18px; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    box-shadow: var(--shadow);
    transition: transform var(--tr), background var(--tr);
    margin-right: 2px;
    flex-shrink: 0;
}
#riddle-share-topbar:hover, #puzzle-share-topbar:hover { transform: scale(1.1); background: var(--card2); }
#riddle-msg, #puzzle-msg {
    text-align: center;
    font-family: var(--font-display);
    font-size: 17px;
    padding: 10px;
    border-radius: var(--radius-sm);
    min-height: 42px;
    margin-top: 6px;
}
#riddle-msg.ok, #puzzle-msg.ok { color: #10b981; background: #10b98115; }
#riddle-msg.err, #puzzle-msg.err { color: #ef4444; background: #ef444415; }
#riddle-msg.warn, #puzzle-msg.warn { color: #f59e0b; background: #f59e0b15; }

.level-tabs { display: flex; gap: 8px; margin-bottom: 12px; }
.level-tab {
    flex: 1; padding: 9px;
    border: 2px solid var(--border); border-radius: var(--radius-sm);
    background: var(--card); font-family: var(--font-display); font-size: 14px;
    color: var(--text2); cursor: pointer; transition: all var(--tr); text-align: center;
}
.level-tab.easy   { background: var(--grad-green);  color: white; border-color: transparent; }
.level-tab.medium { background: var(--grad-yellow); color: #1a1f3c; border-color: transparent; }
.level-tab.hard   { background: var(--grad-red);    color: white; border-color: transparent; }

/* Кружки уровней в топ-баре ребусов */
#puzzle-level-dots, #riddle-level-dots {
    display: flex; gap: 9px; align-items: center; margin-right: 2px;
}
.lvl-dot {
    width: 20px; height: 20px; border-radius: 50%;
    border: 2.5px solid transparent;
    cursor: pointer; transition: transform 0.15s, opacity 0.15s, box-shadow 0.15s;
    opacity: 0.3; padding: 0; flex-shrink: 0;
}
.lvl-dot.easy   { background: #4ade80; }
.lvl-dot.medium { background: #facc15; }
.lvl-dot.hard   { background: #f87171; }
.lvl-dot.active { opacity: 1; transform: scale(1.25); box-shadow: 0 0 8px 2px rgba(255,255,255,0.2); border-color: rgba(255,255,255,0.35); }
.lvl-dot:hover:not(.active) { opacity: 0.7; transform: scale(1.1); }

/* ===== SETTINGS ===== */
.settings-group {
    background: var(--card); border-radius: var(--radius);
    box-shadow: var(--shadow); overflow: hidden; margin-bottom: 14px;
}
.settings-row {
    display: flex; align-items: center; padding: 14px 16px; gap: 13px;
    border-bottom: 1px solid var(--border); transition: background var(--tr);
}
.settings-row:last-child { border-bottom: none; }
.settings-row:hover { background: var(--card2); }
.s-icon  { font-size: 22px; flex-shrink: 0; }
.s-label { flex: 1; font-weight: 500 !important; font-size: 15px; }
.s-sub   { font-size: 12px; color: var(--text2); margin-top: 2px; }
.toggle {
    width: 47px; height: 26px; background: var(--bg2);
    border-radius: 99px; position: relative; cursor: pointer;
    transition: background var(--tr); flex-shrink: 0;
}
.toggle.on { background: var(--grad); }
.toggle::after {
    content: ''; position: absolute;
    width: 20px; height: 20px; background: white;
    border-radius: 50%; top: 3px; left: 3px;
    transition: left var(--tr); box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}
.toggle.on::after { left: 24px; }

/* ===== STATS ===== */
.stat-card {
    background: var(--card); border-radius: var(--radius);
    padding: 18px; box-shadow: var(--shadow);
    display: flex; align-items: center; gap: 14px; margin-bottom: 12px;
}
.stat-icon {
    width: 50px; height: 50px; border-radius: 15px;
    display: flex; align-items: center; justify-content: center;
    font-size: 24px; flex-shrink: 0;
}
.stat-val   { font-family: var(--font-display); font-size: 26px; line-height: 1; }
.stat-lbl   { font-size: 13px; color: var(--text2); font-weight: 500 !important; margin-top: 3px; }
.stat-track { width: 100%; height: 7px; background: var(--bg2); border-radius: 99px; margin-top: 6px; overflow: hidden; }
.stat-fill  { height: 100%; border-radius: 99px; width: 0%; transition: width 1s ease; }

/* ===== INFO ===== */
/* Аккордеон для раздела Информация */
.info-accordion {
    background: var(--card);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    margin-bottom: 10px;
    overflow: hidden;
    transition: box-shadow var(--tr);
}
.info-acc-header {
    flex: 1; display: flex; align-items: center; justify-content: space-between;
    padding: 16px 18px;
    background: none; border: none; cursor: pointer;
    text-align: left; gap: 12px;
}
.info-acc-header-row {
    display: flex; align-items: center;
}
.info-deeplink-btn {
    flex-shrink: 0;
    background: none; border: none;
    padding: 16px 14px 16px 4px;
    font-size: 15px; cursor: pointer;
    opacity: 0.35; transition: opacity 0.15s;
    line-height: 1;
}
.info-accordion:hover .info-deeplink-btn,
.info-accordion.open .info-deeplink-btn { opacity: 0.7; }
.info-deeplink-btn:hover { opacity: 1 !important; }
@media (hover: none) {
    .info-deeplink-btn { opacity: 0.5; }
}
.info-acc-title {
    font-family: var(--font-display); font-size: 17px;
    color: var(--text); font-weight: 500 !important;
    flex: 1;
}
.info-acc-arrow {
    font-size: 22px; color: var(--text2);
    transition: transform 0.25s; display: inline-block; flex-shrink: 0;
    line-height: 1;
}
.info-accordion.open .info-acc-arrow { transform: rotate(90deg); }
.info-acc-body {
    max-height: 0; overflow: hidden;
    transition: max-height 0.5s ease, padding 0.25s;
    padding: 0 18px;
}
.info-accordion.open .info-acc-body {
    max-height: 9999px;
    padding: 0 18px 16px;
}
.info-acc-body p { color: var(--text2); font-size: 13px; font-weight: 300 !important; line-height: 1.75; margin: 0; }
.info-link {
    color: #54ACBF;
    text-decoration: underline;
    text-decoration-color: rgba(84,172,191,0.4);
    text-underline-offset: 3px;
    font-weight: 500 !important;
    transition: color 0.2s, text-decoration-color 0.2s;
}
.info-link:hover { color: #A7EBF2; text-decoration-color: rgba(167,235,242,0.6); }

/* ── Диалог подтверждения удаления ── */
#confirm-overlay {
    position: fixed; inset: 0; z-index: 1000;
    background: rgba(0,0,0,0.45);
    display: flex; align-items: center; justify-content: center;
    opacity: 0; transition: opacity 0.18s;
    padding: 20px;
}
#confirm-overlay.visible { opacity: 1; }
.confirm-box {
    background: var(--card);
    border-radius: var(--radius);
    padding: 24px 22px 18px;
    width: 100%; max-width: 320px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    transform: translateY(12px);
    transition: transform 0.18s;
}
#confirm-overlay.visible .confirm-box { transform: translateY(0); }
.confirm-msg {
    font-size: 16px; color: var(--text);
    font-weight: 500 !important;
    margin-bottom: 20px; line-height: 1.5;
    font-family: var(--font-display);
}
.confirm-btns {
    display: flex; gap: 10px; justify-content: flex-end;
}
.confirm-cancel {
    padding: 10px 18px;
    background: var(--card2); border: 1.5px solid var(--border);
    border-radius: var(--radius-sm);
    font-family: var(--font); font-size: 14px; color: var(--text2);
    cursor: pointer; transition: all var(--tr);
}
.confirm-cancel:hover { background: var(--card); color: var(--text); }
.confirm-ok {
    padding: 10px 18px;
    background: rgba(239,68,68,0.15); border: 1.5px solid rgba(239,68,68,0.35);
    border-radius: var(--radius-sm);
    font-family: var(--font); font-size: 14px; color: #ef4444;
    cursor: pointer; transition: all var(--tr);
}
.confirm-ok:hover { background: rgba(239,68,68,0.25); border-color: #ef4444; }

/* ===== ADMIN ===== */
.admin-tabs {
    display: flex; gap: 8px; flex-wrap: wrap;
    margin-bottom: 14px;
}
.admin-tab {
    flex-shrink: 0; padding: 8px 16px;
    background: var(--card); border: 2px solid var(--border);
    border-radius: 99px; font-family: var(--font-display); font-size: 14px;
    cursor: pointer; transition: all var(--tr); color: var(--text2);
}
.admin-tab.active { background: var(--grad); color: white; border-color: transparent; }
.admin-list {
    flex: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    min-height: 0;
}
.admin-item {
    background: var(--card); border-radius: var(--radius-sm); padding: 13px 15px;
    margin-bottom: 8px; display: flex; align-items: center; gap: 10px; box-shadow: var(--shadow);
}
.admin-item-info { flex: 1; }
.admin-item-title { font-weight: 500 !important; font-size: 14px; font-family: 'Plus Jakarta Sans', sans-serif; }
.admin-item-sub   { font-size: 12px; color: var(--text2); margin-top: 2px; font-family: 'Plus Jakarta Sans', sans-serif; }
.admin-del {
    background: #ef444420; border: none; border-radius: 8px;
    width: 32px; height: 32px; color: #ef4444; cursor: pointer;
    display: flex; align-items: center; justify-content: center; font-size: 15px;
    transition: all var(--tr);
}
.admin-del:hover  { background: #ef4444; color: white; }
.admin-edit {
    background: #3b82f620; border: none; border-radius: 8px;
    width: 32px; height: 32px; color: #3b82f6; cursor: pointer;
    display: flex; align-items: center; justify-content: center; font-size: 15px;
    transition: all var(--tr); margin-right: 3px;
}
.admin-edit:hover { background: #3b82f6; color: white; }
.admin-add-btn {
    display: flex; align-items: center; justify-content: center; gap: 8px;
    width: 100%; padding: 13px; margin-top: 10px; flex-shrink: 0;
    background: var(--grad-green); border: none; border-radius: var(--radius-sm);
    font-family: 'Plus Jakarta Sans', sans-serif; font-size: 17px; font-weight: 500 !important; color: white;
    cursor: pointer; box-shadow: 0 4px 14px rgba(16,185,129,0.3);
    transition: all var(--tr);
}
.admin-add-btn:hover { transform: translateY(-2px); }
.publish-btn {
    display: flex; align-items: center; justify-content: center; gap: 8px;
    width: 100%; padding: 13px; margin-top: 8px; flex-shrink: 0;
    background: var(--grad-purple); border: none; border-radius: var(--radius-sm);
    font-family: 'Plus Jakarta Sans', sans-serif; font-size: 17px; font-weight: 500 !important; color: white;
    cursor: pointer; box-shadow: 0 4px 14px rgba(124,58,237,0.3);
    transition: all var(--tr);
}
.publish-btn:hover { transform: translateY(-2px); }
.publish-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

/* ── GitHub Token поле ── */
.github-token-row {
    background: var(--card2);
    border: 1.5px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 12px 14px;
    margin-top: 8px;
}
.github-token-label {
    font-size: 12px;
    color: var(--text2);
    margin-bottom: 6px;
    letter-spacing: 0.03em;
}
.github-token-input-wrap {
    display: flex; align-items: center; gap: 6px;
}
.github-token-input-wrap input {
    flex: 1;
    background: var(--bg2);
    border: 1.5px solid var(--border);
    border-radius: 10px;
    padding: 9px 12px;
    font-size: 13px;
    color: var(--text);
    font-family: 'SF Mono', 'Fira Code', monospace;
    letter-spacing: 0.03em;
    outline: none;
    transition: border-color var(--tr);
}
.github-token-input-wrap input:focus {
    border-color: var(--luna-mid, #54ACBF);
}
.github-token-eye {
    background: var(--bg2);
    border: 1.5px solid var(--border);
    border-radius: 10px;
    width: 36px; height: 36px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 14px;
    transition: all var(--tr); flex-shrink: 0;
}
.github-token-eye:hover { background: var(--card); }
.github-token-hint {
    font-size: 11px;
    color: var(--text2);
    margin-top: 6px;
}


/* ===== ADMIN LAYOUT ===== */
#admin {
    display: flex;
    flex-direction: column;
    padding-bottom: 18px;
    /* Subtract top-bar height so list fills remaining space */
    max-height: calc(100vh - 70px);
}

/* ===== ADMIN FOOTER (pinned buttons) ===== */
.admin-footer {
    flex-shrink: 0;
    padding-top: 4px;
}
/* ===== MODAL ===== */
.modal-overlay {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.35);
    display: flex; align-items: center; justify-content: center;
    z-index: 9999;
    animation: fadeInUp 0.2s ease;
    padding: 18px;
}
.modal-box {
    background: var(--card);
    width: 100%; max-width: 444px;
    border-radius: var(--radius);
    padding: 22px 20px;
    display: flex; flex-direction: column; gap: 10px;
    box-shadow: var(--shadow-lg);
}
.modal-title { font-family: var(--font-display); font-size: 20px; margin-bottom: 2px; }
.modal-btns  { display: flex; gap: 8px; margin-top: 4px; }
.modal-cancel {
    flex: 1; padding: 12px; background: var(--bg2); border: none;
    border-radius: var(--radius-sm); font-family: var(--font-display);
    font-size: 16px; color: var(--text2); cursor: pointer;
}
.modal-save {
    flex: 2; padding: 12px; background: var(--grad); border: none;
    border-radius: var(--radius-sm); font-family: var(--font-display);
    font-size: 16px; color: white; cursor: pointer;
    box-shadow: 0 3px 10px rgba(120,100,220,0.35);
}
.file-label {
    display: flex; align-items: center; gap: 8px;
    padding: 10px 13px; background: var(--bg2);
    border: 2px dashed var(--border); border-radius: var(--radius-sm);
    cursor: pointer; font-size: 14px; color: var(--text2);
    transition: border-color var(--tr);
}
.file-label:hover { border-color: #a78bfa; }
input[type=file] { display: none; }
.file-chosen { font-size: 12px; color: var(--text2); margin-top: -4px; }

/* ===== TOAST ===== */
#toast {
    position: fixed; bottom: 80px; left: 50%;
    transform: translateX(-50%) translateY(16px);
    background: var(--card); color: var(--text);
    padding: 11px 20px; border-radius: var(--radius-sm);
    box-shadow: var(--shadow-lg); font-weight: 500 !important; font-size: 14px;
    z-index: 9000; opacity: 0; pointer-events: none;
    transition: all 0.28s; white-space: nowrap;
}
#toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

/* ===== STARS ===== */
.stars-host { position: fixed; inset: 0; pointer-events: none; z-index: 9998; overflow: hidden; }
.star {
    position: absolute; border-radius: 50%;
    animation: starFly var(--dur, 1s) ease-out forwards;
}
@keyframes starFly {
    0%   { transform: translate(0,0) scale(1); opacity: 1; }
    100% { transform: translate(var(--tx),var(--ty)) scale(0); opacity: 0; }
}

/* ===== SPINNER ===== */
#loader {
    position: fixed; inset: 0;
    background: var(--bg); display: flex;
    align-items: center; justify-content: center;
    z-index: 9999;
}
.spinner {
    width: 46px; height: 46px; border-radius: 50%;
    border: 4px solid var(--border);
    border-top-color: #a78bfa;
    animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* ===== GRADIENT TEXT ===== */
.gradient-text {
    background: var(--grad);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-family: var(--font-display);
    text-align: center;
    padding-top: 4px;
}
.counter-badge { font-size: 13px; color: var(--text2); font-weight: 500 !important; }

.w100 { width: 100%; }
.sp8  { height: 8px; }
.sp12 { height: 12px; }

/* ===== RIDDLE PICTURE PREVIEW ===== */
/* Base answer-img handles display:none/block, riddle-pic-preview adds layout */
.answer-img.riddle-pic-preview {
    display: none;
    align-items: center;
    justify-content: center;
    background: var(--card);
    border-radius: var(--radius);
    padding: 0;
    overflow: hidden;
    width: 100%;
    aspect-ratio: 1/1;
    margin-bottom: 10px;
    box-shadow: var(--shadow);
}
/* !important нужен чтобы перебить .answer-img.show { display: block } */
.answer-img.riddle-pic-preview.show {
    display: flex !important;
}
.answer-img.riddle-pic-preview img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0;
}

/* ══ MODAL PICTURE PREVIEW ══ */
#m-pic-preview {
    display: none;
    width: 100%;
    aspect-ratio: 1/1;
    object-fit: contain;
    border-radius: var(--radius-sm);
    background: var(--card2);
    border: 2px solid var(--border);
    margin-bottom: 8px;
    max-height: 180px;
}
.m-current-file {
    font-size: 12px;
    color: var(--text2);
    margin-bottom: 6px;
    padding: 6px 10px;
    background: var(--card2);
    border-radius: 8px;
    word-break: break-all;
    display: none;
}
.m-current-file.visible { display: block; }

/* ══ DARK MODE — ПАЛИТРА LUNA ══
   #A7EBF2 #54ACBF #26658C #023859 #011C40 */

/* Плеер в тёмной теме — кнопка play белая на тёмном */





/* Прогресс-бар */




/* Карточки меню */
[data-theme="dark"] .menu-card {
    background: #0a2d54;
    border: 1px solid rgba(38,101,140,0.3);
    color: #d4f0f5;
    box-shadow: 0 4px 20px rgba(1,28,64,0.5);
}
[data-theme="dark"] .menu-card:hover {
    background: #0d3464;
    border-color: rgba(84,172,191,0.35);
    box-shadow: 0 6px 28px rgba(1,28,64,0.7);
}
/* Цветные полоски на плашках в тёмной теме — через Luna */














/* Поля ввода */
[data-theme="dark"] input[type=text],
[data-theme="dark"] input[type=password],
[data-theme="dark"] textarea,
[data-theme="dark"] select {
    background: #023859;
    border-color: rgba(38,101,140,0.5);
    color: #d4f0f5;
}
[data-theme="dark"] input[type=text]:focus,
[data-theme="dark"] textarea:focus {
    border-color: #54ACBF;
    box-shadow: 0 0 0 3px rgba(84,172,191,0.15);
}

/* Кнопка назад */
[data-theme="dark"] #back-btn {
    background: #0a2d54;
    border: 1px solid rgba(38,101,140,0.3);
    color: #7ab8cc;
}

/* Треки в списке */
[data-theme="dark"] .song-item {
    border-bottom-color: rgba(38,101,140,0.2);
}
[data-theme="dark"] .song-item:hover { background: rgba(38,101,140,0.15); }
[data-theme="dark"] .song-item.playing {
    background: linear-gradient(90deg, rgba(84,172,191,0.12), transparent);
}
[data-theme="dark"] .pi-icon { color: #54ACBF; }

/* Админка */
[data-theme="dark"] .admin-tabs {
    
}
[data-theme="dark"] .admin-tab {
    border-color: rgba(38,101,140,0.3);
    color: #7ab8cc;
    background: transparent;
}
[data-theme="dark"] .admin-tab.active {
    background: linear-gradient(135deg, #26658C, #54ACBF);
    border-color: transparent;
    color: #011C40;
}
[data-theme="dark"] .admin-item {
    border: 1px solid rgba(38,101,140,0.2);
    background: #0a2d54;
}

/* Модалка */
[data-theme="dark"] .modal-box {
    background: #023859;
    box-shadow: 0 20px 60px rgba(1,28,64,0.8), 0 0 0 1px rgba(38,101,140,0.3);
}

/* Подсказка */
[data-theme="dark"] .hint-box {
    background: rgba(38,101,140,0.25);
    border: 1px solid rgba(84,172,191,0.2);
    color: #A7EBF2;
}

/* Загадки и ребусы */
[data-theme="dark"] .riddle-box { background: #0a2d54; border-color: rgba(38,101,140,0.2); }
[data-theme="dark"] .puzzle-img-wrap { background: #0a2d54; }

/* Кнопки */
[data-theme="dark"] .submit-btn {
    background: linear-gradient(135deg, #26658C, #54ACBF);
    box-shadow: 0 4px 20px rgba(38,101,140,0.5);
}
[data-theme="dark"] .next-btn {
    background: #023859;
    border: 1px solid rgba(38,101,140,0.3);
    color: #7ab8cc;
}

/* Уровни */
[data-theme="dark"] .level-tab.easy   { background: linear-gradient(135deg,#54ACBF,#A7EBF2); color:#011C40; }
[data-theme="dark"] .level-tab.medium { background: linear-gradient(135deg,#26658C,#54ACBF); color:#d4f0f5; }
[data-theme="dark"] .level-tab.hard   { background: linear-gradient(135deg,#023859,#26658C); color:#A7EBF2; }

/* Настройки и статистика */
[data-theme="dark"] .settings-group {
    background: #0a2d54;
    border: 1px solid rgba(38,101,140,0.2);
}
[data-theme="dark"] .stat-card {
    background: #0a2d54;
    border: 1px solid rgba(38,101,140,0.2);
}

/* Чипы */
[data-theme="dark"] .chip {
    background: #023859;
    border: 1px solid rgba(38,101,140,0.3);
    color: #7ab8cc;
}
[data-theme="dark"] .chip.active {
    background: linear-gradient(135deg, #26658C, #54ACBF);
    border-color: transparent;
    color: #011C40;
}

/* Заголовок страницы */
[data-theme="dark"] #page-title-bar {
    color: #A7EBF2;
    -webkit-text-fill-color: #A7EBF2;
}

/* Скроллбар */
[data-theme="dark"] ::-webkit-scrollbar-track { background: #011C40; }
[data-theme="dark"] ::-webkit-scrollbar-thumb { background: linear-gradient(180deg,#54ACBF,#26658C); }

/* ── Описание подкаста ── */
.podcast-desc {
    font-size: 12px;
    color: var(--text2);
    margin-top: 4px;
    line-height: 1.5;
    display: none;
}
.podcast-desc:not(:empty) { display: block; }

/* ── Плеер в тёмной теме LUNA ── */
[data-theme="dark"] .audio-player {
    background: linear-gradient(135deg, #26658C 0%, #011C40 100%);
    box-shadow: 0 8px 32px rgba(1,28,64,0.6);
}
[data-theme="dark"] #play-btn,
[data-theme="dark"] #song-play-btn,
[data-theme="dark"] #podcast-play-btn {
    background: #A7EBF2;
    color: #011C40;
    box-shadow: 0 4px 20px rgba(167,235,242,0.35);
}
[data-theme="dark"] .ctrl-btn {
    background: rgba(167,235,242,0.12);
    color: rgba(167,235,242,0.8);
}
[data-theme="dark"] .ctrl-btn:hover { background: rgba(167,235,242,0.25); color: #A7EBF2; }
[data-theme="dark"] .ctrl-btn.active { background: rgba(167,235,242,0.3); color: #A7EBF2; }
[data-theme="dark"] .progress-bar-wrap { background: rgba(167,235,242,0.2); }
[data-theme="dark"] .progress-bar-wrap > div { background: rgba(167,235,242,0.8); }
[data-theme="dark"] .progress-bar-wrap > div::after {
    background: #A7EBF2;
    box-shadow: 0 2px 8px rgba(0,0,0,0.4);
}
